<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŠ¤ì™‘ ì»¨íŠ¸ë™íŠ¸ í…ŒìŠ¤íŠ¸ ê²°ê³¼</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .test-button {
            text-align: center;
            margin-bottom: 30px;
        }

        .test-button button {
            background: white;
            color: #667eea;
            border: none;
            padding: 15px 40px;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        .test-button button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .test-button button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .loading {
            text-align: center;
            color: white;
            font-size: 1.2em;
            display: none;
        }

        .spinner {
            border: 4px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top: 4px solid white;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results-container {
            display: none;
        }

        .summary-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .verdict {
            text-align: center;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .verdict.positive {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }

        .verdict.negative {
            background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
            color: white;
        }

        .verdict-icon {
            font-size: 4em;
            margin-bottom: 10px;
        }

        .verdict h2 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .confidence {
            font-size: 1.5em;
            font-weight: bold;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .info-item {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .info-item label {
            display: block;
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .info-item value {
            display: block;
            font-weight: bold;
            color: #333;
            word-break: break-all;
        }

        .findings-section {
            margin-top: 20px;
        }

        .findings-section h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .finding-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #ddd;
        }

        .finding-item.pass {
            border-left-color: #38ef7d;
            background: #e8f5e9;
        }

        .finding-item.fail {
            border-left-color: #f45c43;
            background: #ffebee;
        }

        .finding-item.info {
            border-left-color: #2196f3;
            background: #e3f2fd;
        }

        .finding-item.error {
            border-left-color: #ff9800;
            background: #fff3e0;
        }

        .finding-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .finding-title {
            font-weight: bold;
            font-size: 1.1em;
        }

        .status-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .status-badge.pass {
            background: #38ef7d;
            color: white;
        }

        .status-badge.fail {
            background: #f45c43;
            color: white;
        }

        .status-badge.info {
            background: #2196f3;
            color: white;
        }

        .status-badge.error {
            background: #ff9800;
            color: white;
        }

        .finding-message {
            color: #555;
            margin-bottom: 10px;
        }

        .finding-details {
            background: white;
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
        }

        .detected-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .detected-item {
            background: #667eea;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9em;
        }

        .contract-address {
            background: #333;
            color: #0f0;
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            text-align: center;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .info-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” ìŠ¤ì™‘ ì»¨íŠ¸ë™íŠ¸ ì •ë°€ í…ŒìŠ¤íŠ¸</h1>
            <p>1inch, Uniswap, PancakeSwap ë“± ìŠ¤ì™‘ í”„ë¡œí† ì½œ ê°ì§€ ì‹œìŠ¤í…œ</p>
        </div>

        <div class="test-button">
            <button id="runTestBtn" onclick="runTest()">í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>í…ŒìŠ¤íŠ¸ ì§„í–‰ ì¤‘... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”</p>
        </div>

        <div class="results-container" id="resultsContainer">
            <!-- ê²°ê³¼ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤ -->
        </div>
    </div>

    <script>
        const CONTRACT_ADDRESS = '0x6CE8903FD7advddAde2ec919450544f305708BB8A19a1f';

        async function runTest() {
            const btn = document.getElementById('runTestBtn');
            const loading = document.getElementById('loading');
            const resultsContainer = document.getElementById('resultsContainer');

            // UI ìƒíƒœ ë³€ê²½
            btn.disabled = true;
            loading.style.display = 'block';
            resultsContainer.style.display = 'none';

            try {
                // í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (ì‹¤ì œë¡œëŠ” ë°±ì—”ë“œ API í˜¸ì¶œ)
                const response = await fetch('./test-results.json');
                
                if (!response.ok) {
                    throw new Error('í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € test-swap-contract.jsë¥¼ ì‹¤í–‰í•´ì£¼ì„¸ìš”.');
                }

                const results = await response.json();
                displayResults(results);

            } catch (error) {
                resultsContainer.innerHTML = `
                    <div class="summary-card">
                        <div class="verdict negative">
                            <div class="verdict-icon">âš ï¸</div>
                            <h2>ì˜¤ë¥˜ ë°œìƒ</h2>
                            <p>${error.message}</p>
                            <p style="margin-top: 10px; font-size: 0.9em;">
                                í„°ë¯¸ë„ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”:<br>
                                <code style="background: rgba(0,0,0,0.2); padding: 5px 10px; border-radius: 5px; display: inline-block; margin-top: 5px;">
                                    node coin_status/test-swap-contract.js
                                </code>
                            </p>
                        </div>
                    </div>
                `;
                resultsContainer.style.display = 'block';
            } finally {
                btn.disabled = false;
                loading.style.display = 'none';
            }
        }

        function displayResults(results) {
            const resultsContainer = document.getElementById('resultsContainer');
            
            // íŒì • ê²°ê³¼
            const verdictClass = results.isSwapContract ? 'positive' : 'negative';
            const verdictIcon = results.isSwapContract ? 'âœ…' : 'âŒ';
            const verdictText = results.isSwapContract ? 'ìŠ¤ì™‘ ì»¨íŠ¸ë™íŠ¸ì…ë‹ˆë‹¤' : 'ìŠ¤ì™‘ ì»¨íŠ¸ë™íŠ¸ê°€ ì•„ë‹™ë‹ˆë‹¤';

            let html = `
                <div class="summary-card">
                    <div class="verdict ${verdictClass}">
                        <div class="verdict-icon">${verdictIcon}</div>
                        <h2>${verdictText}</h2>
                        <div class="confidence">ì‹ ë¢°ë„: ${results.confidence}%</div>
                    </div>

                    <div class="contract-address">
                        ğŸ“ ${results.contractAddress}
                    </div>

                    <div class="info-grid">
                        <div class="info-item">
                            <label>í…ŒìŠ¤íŠ¸ ì‹œê°„</label>
                            <value>${new Date(results.timestamp).toLocaleString('ko-KR')}</value>
                        </div>
                        <div class="info-item">
                            <label>ë°”ì´íŠ¸ì½”ë“œ ê¸¸ì´</label>
                            <value>${results.bytecodeAnalysis.bytecodeLength?.toLocaleString() || 'N/A'}</value>
                        </div>
                        <div class="info-item">
                            <label>ë°œê²¬ëœ í•¨ìˆ˜</label>
                            <value>${results.detectedFunctions.length}ê°œ</value>
                        </div>
                        <div class="info-item">
                            <label>ë°œê²¬ëœ ì´ë²¤íŠ¸</label>
                            <value>${results.detectedEvents.length}ê°œ</value>
                        </div>
                    </div>

                    ${results.detectedProtocols.length > 0 ? `
                        <div style="margin-top: 20px;">
                            <h4 style="margin-bottom: 10px;">ğŸ¯ ê°ì§€ëœ í”„ë¡œí† ì½œ</h4>
                            <div class="detected-list">
                                ${results.detectedProtocols.map(p => `<div class="detected-item">${p}</div>`).join('')}
                            </div>
                        </div>
                    ` : ''}

                    ${results.detectedFunctions.length > 0 ? `
                        <div style="margin-top: 20px;">
                            <h4 style="margin-bottom: 10px;">âš™ï¸ ê°ì§€ëœ í•¨ìˆ˜</h4>
                            <div class="detected-list">
                                ${results.detectedFunctions.slice(0, 10).map(f => 
                                    `<div class="detected-item" title="${f.signature}">${f.signature.split('(')[0]}</div>`
                                ).join('')}
                            </div>
                        </div>
                    ` : ''}
                </div>

                <div class="summary-card">
                    <div class="findings-section">
                        <h3>ğŸ“‹ ìƒì„¸ í…ŒìŠ¤íŠ¸ ê²°ê³¼</h3>
                        ${results.findings.map(finding => `
                            <div class="finding-item ${finding.status.toLowerCase()}">
                                <div class="finding-header">
                                    <div class="finding-title">${finding.test}</div>
                                    <div class="status-badge ${finding.status.toLowerCase()}">${finding.status}</div>
                                </div>
                                <div class="finding-message">${finding.message}</div>
                                ${finding.details ? `
                                    <div class="finding-details">
                                        <pre>${JSON.stringify(finding.details, null, 2)}</pre>
                                    </div>
                                ` : ''}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            resultsContainer.innerHTML = html;
            resultsContainer.style.display = 'block';
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ ê²°ê³¼ í‘œì‹œ ì‹œë„
        window.addEventListener('load', () => {
            fetch('./test-results.json')
                .then(response => response.json())
                .then(results => {
                    displayResults(results);
                    document.getElementById('resultsContainer').style.display = 'block';
                })
                .catch(() => {
                    // ê²°ê³¼ íŒŒì¼ì´ ì—†ìœ¼ë©´ ë¬´ì‹œ
                });
        });
    </script>
</body>
</html>
